<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的医学博客 - 个人主页</title>
    <!-- 引入外部样式 -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- 密码大门 -->
    <div id="gate">
        <h2>🔐 私人领域</h2>
        <p>请输入密码进入小c的空间</p>
        <input type="password" id="pwd" placeholder="输入密码..." onkeypress="if(event.key==='Enter')unlock()">
        <button onclick="unlock()">进入</button>
        <p class="error" id="err">密码错误，请重试</p>
    </div>

    <!-- 博客内容 -->
    <div id="blog-content">
        <header>
            <h1>我的医学博客</h1>
            <p>记录学医路上的点滴思考</p>
        </header>
        
        <nav>
            <ul>
                <li><a href="#home">首页</a></li>
                <li><a href="#about">关于我</a></li>
                <li><a href="#blog">博客</a></li>
                <li><a href="#contact">联系方式</a></li>
            </ul>
        </nav>
        
        <div class="container">
            <section id="about" class="about-section">
                <h2>关于我</h2>
                <p>你好！我是一名大四医学生。这个博客是我用来整理学习体会、分享医学见解的地方。</p>
                <p style="margin-top: 1rem;">欢迎你的到来，希望我们能够一起交流学习！</p>
            </section>

            <!-- 医疗免责声明 -->
            <section class="medical-disclaimer">
                <h3>⚠️ 医疗免责声明</h3>
                <p>本网站所有内容（包括但不限于文字、图表、笔记、链接）仅供<strong>教育参考与信息分享</strong>，不构成任何形式的医疗建议、诊断或治疗方案。</p>
                <p>浏览本网站不建立医患关系；内容不能替代专业医疗人员的面诊、诊断或治疗建议；<br>如有健康疑虑，请咨询具有执业资质的医疗卫生提供者。</p>
            </section>
            
            <section id="blog">
                <h2 style="margin-bottom: 1.5rem; color: #6A5A7A;">最新文章</h2>
                <div class="blog-posts">
                    
                    <!-- 文章1：data-file标记文件名，脚本会自动抓取时间 -->
                    <article class="post-card">
                        <h3>我的第一篇博客</h3>
                        <div class="post-meta">
                            发布于 2026-02-01 · 
                            <span class="update-time" data-file="post1.html">获取时间...</span>
                        </div>
                        <p class="post-excerpt">今天终于搭建起了自己的个人博客！作为一名医学生，我希望通过这个平台记录学习过程中的收获与感悟...</p>
                        <a href="post1.html" class="read-more" data-file="post1.html">阅读全文 →</a>
                    </article>
                    
                    <!-- 文章2：外链，不加data-file，保持静态时间 -->
                    <article class="post-card">
                        <h3>医学学习方法及笔记分享</h3>
                        <div class="post-meta">发布于 2026-02-02</div>
                        <p class="post-excerpt">经过几年的医学学习，我正在总结一些对我来说比较有效的学习方法<br>也开始整理存储一些笔记，分享在此...</p>
                        <a href="https://nymeria79.github.io/anki-viewer/" target="_blank" class="read-more">访问网站 →</a>
                    </article>
                    
                    <!-- 文章3：本地文件，自动获取时间 -->
                    <article class="post-card">
                        <h3>示教/实习见闻</h3>
                        <div class="post-meta">
                            发布于 2026-02-02 · 
                            <span class="update-time" data-file="post3.html">获取时间...</span>
                        </div>
                        <p class="post-excerpt">此处存放示教课/实习期间的见闻和思考</p>
                        <a href="post3.html" class="read-more" data-file="post3.html">阅读全文 →</a>
                    </article>

                    <!-- 示例：如何添加新文章（带自动时间） -->
                    <article class="post-card">
                        <h3>新文章标题</h3>
                        <div class="post-meta">
                            发布于 2026-02-02 · 
                            <span class="update-time" data-file="post4.html">获取时间...</span>
                        </div>
                        <p class="post-excerpt">文章摘要...</p>
                        <a href="post4.html" class="read-more" data-file="post4.html">阅读全文 →</a>
                    </article>

                </div>
            </section>
        </div>
        
        <footer id="contact">
            <p>© 2026 xiaoc的医学博客 | 用心记录，与你分享</p>
            <p>yejingyang163@163.com</p>
        </footer>
    </div>

    <script>
        // ===== 密码功能 =====
        const PASSWORD = "xiaoc";
        
        if(localStorage.getItem("unlocked") === "yes") {
            document.getElementById("gate").style.display = "none";
            document.getElementById("blog-content").style.display = "block";
        }
        
        function unlock() {
            if(document.getElementById("pwd").value === PASSWORD) {
                localStorage.setItem("unlocked", "yes");
                document.getElementById("gate").style.display = "none";
                document.getElementById("blog-content").style.display = "block";
            } else {
                document.getElementById("err").style.display = "block";
                document.getElementById("pwd").value = "";
            }
        }

        // ===== 自动获取GitHub最后修改时间 =====
        // 配置（已按你的仓库设置好）
        const GITHUB_USER = 'Nymeria79';
        const GITHUB_REPO = 'my-page';
        const CACHE_KEY = 'blog_update_times';
        const CACHE_MINUTES = 30; // 缓存30分钟，避免频繁请求

        // 读取缓存
        function getCache() {
            try {
                const data = JSON.parse(localStorage.getItem(CACHE_KEY) || '{}');
                if (Date.now() - (data.ts || 0) < CACHE_MINUTES * 60000) {
                    return data.times || {};
                }
            } catch(e) {}
            return {};
        }

        // 保存缓存
        function saveCache(times) {
            localStorage.setItem(CACHE_KEY, JSON.stringify({
                ts: Date.now(),
                times: times
            }));
        }

        // 获取单个文件时间
        async function fetchTime(filename) {
            const cache = getCache();
            if (cache[filename]) return cache[filename];

            try {
                const res = await fetch(`https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/commits?path=${filename}&per_page=1`);
                if (!res.ok) throw new Error('API错误');
                const data = await res.json();
                if (data.length > 0) {
                    const date = new Date(data[0].commit.committer.date);
                    // 格式：02-02 14:30
                    const str = `${String(date.getMonth()+1).padStart(2,'0')}-${String(date.getDate()).padStart(2,'0')} ${String(date.getHours()).padStart(2,'0')}:${String(date.getMinutes()).padStart(2,'0')}`;
                    cache[filename] = str;
                    saveCache(cache);
                    return str;
                }
            } catch(e) {
                console.log('获取失败:', filename);
            }
            return null;
        }

        // 页面加载后自动获取所有时间
        document.addEventListener('DOMContentLoaded', async () => {
            const timeElements = document.querySelectorAll('.update-time[data-file]');
            
            for (let el of timeElements) {
                const file = el.getAttribute('data-file');
                const time = await fetchTime(file);
                if (time) {
                    el.textContent = '最后修改：' + time;
                    el.style.color = '#7A6A8A'; // 成功获取后加深颜色
                } else {
                    el.textContent = '最后修改：未知';
                    el.style.color = '#bbb';
                }
            }
        });
    </script>
</body>
</html>